# netlify.toml

[build]
  publish   = "."
  functions = "netlify/functions"

[functions]
  node_bundler = "esbuild"

# API ↔︎ Function
[[redirects]]
  from = "/api/generate"
  to   = "/.netlify/functions/gemini-proxy"
  status = 200
  force  = true

# Admin route ↔︎ static file
[[redirects]]
  from = "/admin"
  to   = "/admin/index.html"
  status = 200

# (اختياري) لو أردت أن كل الروابط الفرعية تحت /admin/* تفتح نفس الملف
# [[redirects]]
#   from = "/admin/*"
#   to   = "/admin/index.html"
#   status = 200

# Security headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "SAMEORIGIN"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"

# جلسة جديدة لكل مستخدم
[[redirects]]
  from = "/api/create-session"
  to   = "/.netlify/functions/create-session"
  status = 200
  force  = true

# إرسال/جلب رسائل جلسة واحدة
[[redirects]]
  from = "/api/chat"
  to   = "/.netlify/functions/chat"
  status = 200
  force  = true
